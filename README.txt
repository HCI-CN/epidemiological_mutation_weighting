Note that this repo has been archived. Contact information can be found in OpenBSD_License.txt.
====File Descriptions====
1. The Results directory contains the output data used in the manuscript that is generated by the Analysis_Code notebook. The final figures shown in the manuscript generated using the graph 
   functionality of Microsoft Excel.

2. The Input Files directory contains input data files for all analysis conducted using the Analysis_Code notebook.

3. The Analysis_Code.nb is a Mathematica notebook created to generate the weighted epidemiological data, stratify MSK LUAD patients by smoking/gender, and format untreated MSK/TCGA patient cohort mutation 
   data for processing using the Signature Analyzer software program.

4. Analysis_Code.pdf is a pdf copy of the Mathematica notebook above; it can be printed/viewed to peruse the code without installing the Mathematica software.

5. The Other directory contains data that is not used within the Analysis_Code notebook but might otherwise be of interest in helping to interpret the rationale used for the code.  Two pieces of data from 
   derived from the supplementary data of Mendiratta, G., Ke, E., Aziz, M. et al. Cancer gene mutation frequencies for the U.S. population. Nat Commun 12, 5961 (2021). https://doi.org/10.1038/
   s41467-021-26213-y are presented, as their mutation and epidemiological data were used to generate the US data for comparison with the CN data. How these data were used can be found within the 
   Analysis_Code.nb file.


====Installation and Execution Guide====

A. Running the code - Analysis_Code.nb:

The code was written using Mathematica 13. Mathematica is is available for Windows, Mac, and Linux. 
A 15-day trial of Mathematica can be downloaded at: https://www.wolfram.com/mathematica/trial.
As of 2022/07/15, Mathematica software is bundled with standard Raspberry Pi computers. See https://www.raspberrypi.com/ for details.
A full license for the software can be purchased at: https://www.wolfram.com/mathematica/pricing.

A great resource for those unfamiliar with the Wolfram Language can be found at: https://www.wolfram.com/language/elementary-introduction/2nd-ed/  

Mathematica Version 12 (and up) is recommended for executing the code. Once the software is installed, the Analysis_Code.nb file can be opened. 

	The code is presented in the file, Analysis_Code.nb. Double clicking the file will launch the notebook in Mathematica.  Comments that indicate what each step accomplished denoted in purple font.  Note: User-specific path information pointing towards the files used within the code are marked in red font. The path information for each file can usually be found by right-clicking a file and clicking Properties (Linux). The code is organized into sections whose tasks are indicated by the title of the sections and sub-sections (the first sub-section of "Formatting Data for Mutation Signature Analysis" is dependent upon a few variables generated in the second section).  For the sake of simplicity, one should first input path information to each file and the desired directory for output data prior to attempting to execute the code.  Once the path information has been inputted, the code in each cell is executed by holding the Shift-key and pressing the Enter-key. Output is suppressed by the inclusion of a semicolon (;) at the end of each cell.  Should the user wish to see the output generated by each step the code, one should remove the semicolon. Execution of the code is reflected in the cursor shifting to the bottom of the cell. Most code is executed in a matter of seconds, but a few cells may take up to a few (<2) minutes to complete depending upon the computer system. As mentioned above, the results section contains the output of the code that is presented within the manuscript. Note: individual results generated for the simulated US and CN data will vary slightly due to the random seeding used within the software.  
 
B. Required files not provided in the Supplementary Software directory

	Mutation data used to generate total and treatment-naive mutation signatures for the TCGA-SKCM and TCGA-PTC cohorts was downloaded using Broad Firebrowse (www.firebrowse.org).  Using the tab, each cohort of interest (SKCM and THCA) were selected. The Mutation_Packager_Raw_Calls directory were then downloaded for each cohort. Treatment status can be verified by scripting using the clinical information of each respective cohort, which is also available on the Firebrowse website.  

Alternatively, the treatment status of each patient can be verified using the clinical information downloaded directly from the TCGA website (https://portal.gdc.cancer.gov/repository).  The cohort of interest should be checked within the drop-down menu on the left-side of the website. One would then click "Cases" and subsequently download the clinical information. The benefit of downloading the data directly from TCGA is that it is presented in a simple format, and information is relatively easy to locate. However, if one requires a richer set of information, then the clinical data from the Firebrowse website delivers that.

C.  Mutation Signature Analysis

	Mutation signature analysis was conducted using the Signature Analyzer software in Python3.6. The signature analyzer program can be downloaded using the command line via the pip3 command:

pip3 install signatureanalyzer

	The pandas package is also required to execute the SignatureAnalyzer program (Alexandrov, L.B., Kim, J., Haradhvala, N. J., Huang, M.N., Ng, A.W.T., Wu,Y.,...& Islam, S.A. (2020). The repertoire of mutational signatures in human cancer. Nature, 578(7793), 94-101). Pandas can be downloaded using the command line via the pip3 command:

pip3 install pandas

	Once both packages are installed, the user can initialize Python and input the following code:

import signatureanalyzer as sa
import pandas as pd
maf_df = pd.read_csv('/path/to/mutationSignatures.csv', sep=',').loc[:,[
'Hugo_Symbol',
'Tumor_Sample_Barcode',
'Chromosome',
'Start_Position',
'Reference_Allele',
'Tumor_Seq_Allele2',
'Variant_Type']]
_,spectra_sbs = sa.spectra.get_spectra_from_maf(maf_df, cosmic = 'cosmic3', hgfile = '/path/to/hg19.2bit')
spectra_sbs.to_csv(r'/path/to/Destination/sbsOutput.csv)
sa.run_spectra('/path/to/sbsOutput.csv', outdir = 'path/to/Destination/', cosmic = 'cosmic3', nruns = 10)

	The program outputs five files within the set directory. These files include: cosine_similarity_plot.pdf, k_dist.pdf, nmf_output.hf, signature_contributions.pdf, and signature_stacked_barplot.pdf. Further details regarding the SignatureAnalyzer program can be found at: https://pypi.org/project/signatureanalyzer/

